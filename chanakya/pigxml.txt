
hdfs dfs -put /home/orienit/pig/employee1.xml /user/orienit/pig/employee1.xml

REGISTER /usr/lib/pig/piggybank.jar



M = load '/user/orienit/pig/employee1.xml' using org.apache.pig.piggybank.storage.XMLLoader('employee') as (x:chararray);

dump M

N=FOREACH M GENERATE XPath(x, 'employee/empid'), XPath(x, 'employee/name'), XPath(x, 'employee/salary'),XPath(x, 'employee/dept');

dump N


employee1_op = store 


employee1_op = filter N BY $0 > 2 and $3='dev';


filtered_records = FILTER records BY temperature != 9999 AND (quality == 0 OR quality == 1 OR quality == 4 OR quality == 5 OR quality == 9);
DUMP filtered_records;


